"use strict";(self.webpackChunklinkedin_clone_documentation=self.webpackChunklinkedin_clone_documentation||[]).push([[8363],{8215:function(e,t,n){n.d(t,{Z:function(){return i}});var a=n(7294);function i(e){var t=e.children,n=e.hidden,i=e.className;return a.createElement("div",{role:"tabpanel",hidden:n,className:i},t)}},9877:function(e,t,n){n.d(t,{Z:function(){return d}});var a=n(7462),i=n(7294),o=n(2389),r=n(3725),s=n(6010),l="tabItem_LplD";function u(e){var t,n,o,u=e.lazy,d=e.block,p=e.defaultValue,m=e.values,c=e.groupId,h=e.className,g=i.Children.map(e.children,(function(e){if((0,i.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),k=null!=m?m:g.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),f=(0,r.lx)(k,(function(e,t){return e.value===t.value}));if(f.length>0)throw new Error('Docusaurus error: Duplicate values "'+f.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var w=null===p?p:null!=(t=null!=p?p:null==(n=g.find((function(e){return e.props.default})))?void 0:n.props.value)?t:null==(o=g[0])?void 0:o.props.value;if(null!==w&&!k.some((function(e){return e.value===w})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+w+'" but none of its children has the corresponding value. Available values are: '+k.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var b=(0,r.UB)(),v=b.tabGroupChoices,N=b.setTabGroupChoices,y=(0,i.useState)(w),I=y[0],C=y[1],S=[],T=(0,r.o5)().blockElementScrollPositionUntilNextRender;if(null!=c){var F=v[c];null!=F&&F!==I&&k.some((function(e){return e.value===F}))&&C(F)}var x=function(e){var t=e.currentTarget,n=S.indexOf(t),a=k[n].value;a!==I&&(T(t),C(a),null!=c&&N(c,a))},M=function(e){var t,n=null;switch(e.key){case"ArrowRight":var a=S.indexOf(e.currentTarget)+1;n=S[a]||S[0];break;case"ArrowLeft":var i=S.indexOf(e.currentTarget)-1;n=S[i]||S[S.length-1]}null==(t=n)||t.focus()};return i.createElement("div",{className:"tabs-container"},i.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":d},h)},k.map((function(e){var t=e.value,n=e.label,o=e.attributes;return i.createElement("li",(0,a.Z)({role:"tab",tabIndex:I===t?0:-1,"aria-selected":I===t,key:t,ref:function(e){return S.push(e)},onKeyDown:M,onFocus:x,onClick:x},o,{className:(0,s.Z)("tabs__item",l,null==o?void 0:o.className,{"tabs__item--active":I===t})}),null!=n?n:t)}))),u?(0,i.cloneElement)(g.filter((function(e){return e.props.value===I}))[0],{className:"margin-vert--md"}):i.createElement("div",{className:"margin-vert--md"},g.map((function(e,t){return(0,i.cloneElement)(e,{key:t,hidden:e.props.value!==I})}))))}function d(e){var t=(0,o.Z)();return i.createElement(u,(0,a.Z)({key:String(t)},e))}},2063:function(e,t,n){n.r(t),n.d(t,{assets:function(){return h},contentTitle:function(){return m},default:function(){return f},frontMatter:function(){return p},metadata:function(){return c},toc:function(){return g}});var a=n(7462),i=n(3366),o=(n(7294),n(3905)),r=n(2004),s=n(2867),l=n(9877),u=n(8215),d=["components"],p={slug:"chat-smart-replies",title:"Building LinkedIn Chat with Smart Replies in Flutter",authors:["ab"],tags:["programming","development","flutter","linkedin","ai"]},m=void 0,c={permalink:"/linkedin-clone/blog/chat-smart-replies",editUrl:"https://github.com/Imperial-lord/linkedin-clone/blog/2022-03-10-chat-smart-replies/index.mdx",source:"@site/blog/2022-03-10-chat-smart-replies/index.mdx",title:"Building LinkedIn Chat with Smart Replies in Flutter",description:"Wondering how the LinkedIn chat works with those nice little suggestions corresponding to your and your peers\u2019 messages? Well, wonder no more. In this article, we are going to build just that. For this tutorial, we will be using Flutter, one of the most famous cross-platform mobile app development frameworks. And there is more to that since we will be learning technologies such as Firebase, Radar, Google ML Kit, and more\u2026",date:"2022-03-10T00:00:00.000Z",formattedDate:"March 10, 2022",tags:[{label:"programming",permalink:"/linkedin-clone/blog/tags/programming"},{label:"development",permalink:"/linkedin-clone/blog/tags/development"},{label:"flutter",permalink:"/linkedin-clone/blog/tags/flutter"},{label:"linkedin",permalink:"/linkedin-clone/blog/tags/linkedin"},{label:"ai",permalink:"/linkedin-clone/blog/tags/ai"}],readingTime:6.2,truncated:!1,authors:[{name:"AB Satyaprakash",title:"Upcoming Software Engineer @ Oracle",url:"https://www.linkedin.com/in/ab-satyaprakash/",imageURL:"https://i.ibb.co/KXGgnw9/6-DD85-A2-D-7524-4-E2-F-83-E0-57416346-D35-D-1-201-a.jpg",key:"ab"}],frontMatter:{slug:"chat-smart-replies",title:"Building LinkedIn Chat with Smart Replies in Flutter",authors:["ab"],tags:["programming","development","flutter","linkedin","ai"]},nextItem:{title:"Welcome",permalink:"/linkedin-clone/blog/welcome"}},h={authorsImageUrls:[void 0]},g=[{value:"User Info",id:"user-info",level:2},{value:"Chat Window",id:"chat-window",level:2},{value:"Chat Input",id:"chat-input",level:2}],k={toc:g};function f(e){var t=e.components,n=(0,i.Z)(e,d);return(0,o.kt)("wrapper",(0,a.Z)({},k,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Wondering how the LinkedIn chat works with those nice little suggestions corresponding to your and your peers\u2019 messages? Well, wonder no more. In this article, we are going to build just that. For this tutorial, we will be using ",(0,o.kt)("strong",{parentName:"p"},"Flutter"),", one of the most famous cross-platform mobile app development frameworks. And there is more to that since we will be learning technologies such as ",(0,o.kt)("strong",{parentName:"p"},"Firebase"),", ",(0,o.kt)("strong",{parentName:"p"},"Radar"),", ",(0,o.kt)("strong",{parentName:"p"},"Google ML Kit"),", and more\u2026"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://miro.medium.com/max/1400/1*JPkVxDrgjLxA25s9U70rJA.png",alt:null})),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"If you love video tutorials more, I got you covered.")," Watch the video below for complete implementation, and let\u2019s build this project together!"),(0,o.kt)(r.Z,{controls:!0,url:"https://youtu.be/6KfpMSPGUeA",mdxType:"ReactPlayer"}),(0,o.kt)("br",null),(0,o.kt)("p",null,"Firebase is Google\u2019s flagship product for application development. Technically, it is a ",(0,o.kt)("strong",{parentName:"p"},"backend as a service")," (",(0,o.kt)("a",{parentName:"p",href:"https://blog.back4app.com/backend-as-a-service-firebase/"},(0,o.kt)("strong",{parentName:"a"},"BaaS")),"), which means we get most of the commonly used backend functionalities out of the box, ensuring faster development cycles. We will use Firebase in our case for authenticating users \u2014 ",(0,o.kt)("strong",{parentName:"p"},"Firebase Auth")," and for its NoSQL database \u2014 ",(0,o.kt)("strong",{parentName:"p"},"Cloud Firestore"),"."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://radar.com"},"Radar")," is a famous location service provider that we will be using for its reverse geocoding APIs to fetch the address from the user location."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://developers.google.com/ml-kit"},"Google ML Kit")," provides many commonly used machine learning models as APIs for mobile applications \u2014 such as ",(0,o.kt)("strong",{parentName:"p"},"Vision APIs")," (Object detection, Selfie segmentation, etc.) and ",(0,o.kt)("strong",{parentName:"p"},"Natural Language APIs")," (Translation, Writing detection, Smart Replies, etc.). We will be particularly interested in the ",(0,o.kt)("strong",{parentName:"p"},"Smart Replies API"),". Let\u2019s get started now and see how to use these."),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Did you know that we can also use ",(0,o.kt)("strong",{parentName:"p"},"Mapbox")," for reverse geocoding and other functionalities? It is as good as Google Maps, only cheaper. ",(0,o.kt)("a",{parentName:"p",href:"https://medium.com/nerd-for-tech/turn-by-turn-navigation-with-mapbox-16f874567b3c"},"Here")," I talk about how we can use its navigation APIs to build an ",(0,o.kt)("strong",{parentName:"p"},"Uber"),"-","like application."))),(0,o.kt)("h1",{id:"getting-started"},"Getting Started"),(0,o.kt)("p",null,"For easy onboarding, I have a starter application ready for you, which you can run with just a few changes. The application has a basic LinkedIn-like UI and a layout for the Chat feature, and we have already implemented Firebase and Radar. You can find the link to the GitHub repository below."),(0,o.kt)(l.Z,{mdxType:"Tabs"},(0,o.kt)(u.Z,{value:"github",label:"GitHub",default:!0,mdxType:"TabItem"},"\ud83d\udc19 GitHub repository link:",(0,o.kt)("a",{href:"https://github.com/Imperial-lord/linkedin-clone/"}," https://github.com/Imperial-lord/linkedin-clone/")),(0,o.kt)(u.Z,{value:"docusaurus",label:"Docusaurus",mdxType:"TabItem"},"\ud83d\udcdc Docusaurus website link:",(0,o.kt)("a",{href:"https://imperial-lord.github.io/linkedin-clone/"}," https://imperial-lord.github.io/linkedin-clone/"))),(0,o.kt)("p",null,"The changes you will need for running the initial application can be found in this documentation website that we have built using Facebook\u2019s Open Source documentation tool \u2014 ",(0,o.kt)("strong",{parentName:"p"},"Docusaurus"),"."),(0,o.kt)("p",null,"Once you have run the application, it will look like this \u2014"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://miro.medium.com/max/1400/1*MnFRTHca7Ta2aI3F7CInCA.gif",alt:null}),(0,o.kt)("em",{parentName:"p"},"A 25 second GIF to show the how initial app looks before any changes are made")),(0,o.kt)("h1",{id:"building-the-chat-ui"},"Building the Chat UI"),(0,o.kt)("p",null,"Our chat UI will consist of 3 parts (and correspondingly 3 widgets) -"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"User Info")," \u2014 the name and headline of the User"),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Chat Window")," \u2014 a scrollable list of messages with user details and timestamp of the messages sent"),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Chat Input")," \u2014 an input field using the ",(0,o.kt)("inlineCode",{parentName:"li"},"CupertinoTextField"),", and animated button to show additional options for adding images, GIFs, etc. Here, we will be offering the suggestions using ",(0,o.kt)("inlineCode",{parentName:"li"},"Chip")," widgets.")),(0,o.kt)("h2",{id:"user-info"},"User Info"),(0,o.kt)("p",null,"For building this section, we will use the app-wide state management we have maintained using ",(0,o.kt)("strong",{parentName:"p"},"Providers")," and ",(0,o.kt)("strong",{parentName:"p"},"MobX"),". To show the user name and headline, we simply need to use ",(0,o.kt)("inlineCode",{parentName:"p"},"userStore.name")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"userStore.headline")," inside UI widget ",(0,o.kt)("inlineCode",{parentName:"p"},"UserInfo()"),". This is what it will look like when done."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://miro.medium.com/max/1400/1*8ZBCcE0p7DFbdRCN8ZavXw.png",alt:null})),(0,o.kt)("h2",{id:"chat-window"},"Chat Window"),(0,o.kt)("p",null,"For building this we make use of a ",(0,o.kt)("inlineCode",{parentName:"p"},"StreamBuilder"),", and listen to the stream:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"FirebaseFirestore.instance.collection(groupChatId).doc(groupChatId).collection().snapshots()\n")),(0,o.kt)("p",null,"Once we fetch the data from there (while listening to changes as well), we use ",(0,o.kt)("inlineCode",{parentName:"p"},"ListView.builder()")," to render the data in descending order of time."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="chat_window.dart"',title:'"chat_window.dart"'},"Widget buildListMessage() {\n    return Expanded(\n      child: groupChatId == ''\n          ? const Center(child: CircularProgressIndicator())\n          : StreamBuilder<QuerySnapshot>(\n              stream: FirebaseFirestore.instance\n                  .collection('Messages')\n                  .doc(groupChatId)\n                  .collection(groupChatId)\n                  .orderBy('timestamp', descending: true)\n                  .snapshots(),\n              builder: (context, snapshot) {\n                if (!snapshot.hasData) {\n                  return const Center(child: CircularProgressIndicator());\n                } else {\n                  listMessage = snapshot.data!.docs;\n                  chatStore.chatMessages = [];\n                  for (int i = listMessage.length - 1; i >= 0; i--) {\n                    chatStore.addChatMessages(listMessage[i].get('content'),\n                        listMessage[i].get('idFrom'));\n                  }\n\n                  return Padding(\n                    padding: const EdgeInsets.only(left: 10),\n                    child: ListView.builder(\n                      padding: EdgeInsets.zero,\n                      itemBuilder: (context, index) =>\n                          buildItem(index, (snapshot.data?.docs)![index]),\n                      itemCount: snapshot.data?.docs.length,\n                      reverse: true,\n                      controller: listScrollController,\n                    ),\n                  );\n                }\n              },\n            ),\n    );\n  }\n")),(0,o.kt)("p",null,"We also make use of a helper function to know when to show the name and timestamp (or headers as I will call them), ",(0,o.kt)("strong",{parentName:"p"},"which are shown only if 2 consecutive messages are from different users.")," ",(0,o.kt)("em",{parentName:"p"},"You can change the last part to your need, to design different UX. For instance you can go ahead and show headers whenever 2 messages differ by a specific time say 2 hours or more.")),(0,o.kt)("h2",{id:"chat-input"},"Chat Input"),(0,o.kt)("p",null,"For building this, we use the ",(0,o.kt)("inlineCode",{parentName:"p"},"CupertinoTextField"),", and whenever the input is submitted, we store the content to Firestore using the ",(0,o.kt)("inlineCode",{parentName:"p"},"onSendMessage")," function inside ",(0,o.kt)("inlineCode",{parentName:"p"},"ChatStore"),", which looks like this."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="chat_window.dart"',title:'"chat_window.dart"'},"  @action\n  void onSendMessage(String content, String groupChatId, String id) {\n    if (content.trim() != '') {\n      var documentReference = FirebaseFirestore.instance\n          .collection('Messages')\n          .doc(groupChatId)\n          .collection(groupChatId)\n          .doc(DateTime.now().millisecondsSinceEpoch.toString());\n\n      FirebaseFirestore.instance.runTransaction((transaction) async {\n        transaction.set(\n          documentReference,\n          {\n            'idFrom': id,\n            'idTo': peerId,\n            'timestamp': DateTime.now().millisecondsSinceEpoch.toString(),\n            'content': content,\n          },\n        );\n      });\n      listScrollController.animateTo(0.0,\n          duration: const Duration(milliseconds: 300), curve: Curves.easeOut);\n    }\n  }\n")),(0,o.kt)("p",null,"We also add an animated button. With its help and using the ",(0,o.kt)("inlineCode",{parentName:"p"},"Visibility")," widget, we create this beautiful animation to toggle viewing of extra options to add images, GIFs, etc."),(0,o.kt)("p",null,"Love this article so far? Go ahead and ",(0,o.kt)("a",{parentName:"p",href:"https://medium.com/@absatyaprakash01"},"follow me"),", and also remember to add yourself to my mailing list so that ",(0,o.kt)("strong",{parentName:"p"},"you get an email whenever I publish"),"!"),(0,o.kt)("h1",{id:"showing-smart-replies"},"Showing Smart Replies"),(0,o.kt)("p",null,"Now coming to the most interesting part, we will be using this plugin \u2014 ",(0,o.kt)("a",{parentName:"p",href:"https://pub.dev/packages/smart_reply"},"smart_reply")," which makes use of the ",(0,o.kt)("strong",{parentName:"p"},"Google ML Kit Natural Language APIs")," to generate smart replies. The best part about this is that since these models run on device the results are much ",(0,o.kt)("strong",{parentName:"p"},"faster")," than if it were conventionally hosted on a server. This how the function to generate suggestions look like."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="chat_suggestions.dart"',title:'"chat_suggestions.dart"'},"  void getSuggestions(messages) async {\n    // Fetch suggestions using Google ML Kit and rebuild page\n    List oldSuggestions = suggestions;\n    suggestions = await const SmartReply().suggestReplies(messages);\n    if (!listEquals(oldSuggestions, suggestions)) {\n      setState(() {});\n    }\n  }\n")),(0,o.kt)("p",null,"Note that here we are rebuilding the widget, if the older suggestions are different from the newer suggestions (this way we ensure that the rebuilding is more efficient). The suggestions are generated as an array of Strings with size at max 3. We then make use of these as content for the chips, and we call the same function ",(0,o.kt)("inlineCode",{parentName:"p"},"onSendMessage")," as before, whenever the chips are tapped to send the message. The final result looks something like this (click on the link below for the video) \u2014"),(0,o.kt)(r.Z,{controls:!0,url:s.Z,height:"100%",width:"100%",mdxType:"ReactPlayer"}),(0,o.kt)("br",null),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Check out the post I made on LinkedIn along with the video ",(0,o.kt)("a",{parentName:"p",href:"https://www.linkedin.com/feed/update/urn:li:activity:6906414938382856192/"},"here"),"!"))),(0,o.kt)("h1",{id:"conclusion"},"Conclusion"),(0,o.kt)("p",null,"And just like that we have implemented a ",(0,o.kt)("strong",{parentName:"p"},"LinkedIn")," like Chat which also supports ",(0,o.kt)("strong",{parentName:"p"},"Smart Replies"),". The good part about this is we can replicate the steps in this tutorial, to any other project as well, where you might wanna use the Chat feature (and optionally the Smart replies feature). In brief, this is how the final implementation looks like \u2014"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://miro.medium.com/max/1400/1*DmU9QQoZE7cyiw4Ej2YvZA.png",alt:null})),(0,o.kt)("p",null,"Feel free to reach out to me for any questions or suggestions that you might have. You can follow me on these social media platforms \u2014 ",(0,o.kt)("a",{parentName:"p",href:"https://www.linkedin.com/in/ab-satyaprakash/"},"LinkedIn"),", ",(0,o.kt)("a",{parentName:"p",href:"https://www.youtube.com/channel/UCJ6D0HS8c9Il-eX5lGbAyGg"},"YouTube"),", ",(0,o.kt)("a",{parentName:"p",href:"https://twitter.com/AbSatyaprakash"},"Twitter"),", ",(0,o.kt)("a",{parentName:"p",href:"https://www.instagram.com/absatyaprakash/"},"Instagram")," for more updated content!"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"As always! Happy Hacking! \ud83d\ude07")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://absatyaprakash01.medium.com/subscribe"},"Join my email list for more awesome tutorials and programming blogs")," \u2764\ufe0f"))}f.isMDXComponent=!0},2867:function(e,t,n){t.Z=n.p+"assets/medias/final_demo-c2522858df287fcf844eb021fe09cd2e.mp4"}}]);